#!/usr/bin/env python3
'''Simple test facility'''
import os
import sys
import unittest
from Bio.Seq import Seq

minvar_dir = os.path.dirname(os.path.dirname(os.path.abspath(__file__)))
os.sys.path.insert(1, minvar_dir)
mod = __import__('minvar')
sys.modules["minvar"] = mod

from minvar.annotate import extract_hcv_orf

subtype1a = '''GCCAGCCCCCTGATGGGGGCGACACTCCACCATGAATCACTCCCCTGTGAGGAACTACTG\
TCTTCACGCAGAAAGCGTCTAGCCATGGCGTTAGTATGAGTGTCGTGCAGCCTCCAGGAC\
CCCCCCTCCCGGGAGAGCCATAGTGGTCTGCGGAACCGGTGAGTACACCGGAATTGCCAG\
GACGACCGGGTCCTTTCTTGGATCAACCCGCTCAATGCCTGGAGATTTGGGCGTGCCCCC\
GCAAGACTGCTAGCCGAGTAGTGTTGGGTCGCGAAAGGCCTTGTGGTACTGCCTGATAGG\
GTGCTTGCGAGTGCCCCGGGAGGTCTCGTAGACCGTGCACCATGAGCACGAATCCTAAAC\
CTCAAAAAAAAAACAAACGTAACACCAACCGTCGCCCACAGGACGTCAAGTTCCCGGGTG\
GCGGTCAGATCGTTGGTGGAGTTTACTTGTTGCCGCGCAGGGGCCCTAGATTGGGTGTGC\
GCGCGACGAGAAAGACTTCCGAGCGGTCGCAACCTCGAGGTAGACGTCAGCCTATCCCCA\
AGGCTCGTCGGCCCGAGGGCAGGACCTGGGCTCAGCCCGGGTACCCTTGGCCCCTCTATG\
GCAATGAGGGCTGCGGGTGGGCGGGATGGCTCCTGTCTCCCCGTGGCTCTCGGCCTAGCT\
GGGGCCCCACAGACCCCCGGCGTAGGTCGCGCAATTTGGGTAAGGTCATCGATACCCTTA\
CGTGCGGCTTCGCCGACCTCATGGGGTACATACCGCTCGTCGGCGCCCCTCTTGGAGGCG\
CTGCCAGGGCCCTGGCGCATGGCGTCCGGGTTCTGGAAGACGGCGTGAACTATGCAACAG\
GGAACCTTCCTGGTTGCTCTTTCTCTATCTTCCTTCTGGCCCTGCTCTCTTGCTTGACTG\
TGCCCGCTTCGGCCTACCAAGTGCGCAACTCCACGGGGCTTTACCACGTCACCAATGATT\
GCCCTAACTCGAGTATTGTGTACGAGGCGGCCGATGCCATCCTGCACACTCCGGGGTGCG\
TCCCTTGCGTTCGTGAGGGCAACGCCTCGAGGTGTTGGGTGGCGATGACCCCTACGGTGG\
CCACCAGGGATGGCAAACTCCCCGCGACGCAGCTTCGACGTCACATCGATCTGCTTGTCG\
GGAGCGCCACCCTCTGTTCGGCCCTCTACGTGGGGGACCTATGCGGGTCTGTCTTTCTTG\
TCGGCCAACTGTTCACCTTCTCTCCCAGGCGCCACTGGACGACGCAAGGTTGCAATTGCT\
CTATCTATCCCGGCCATATAACGGGTCACCGCATGGCATGGGATATGATGATGAACTGGT\
CCCCTACGACGGCGTTGGTAATGGCTCAGCTGCTCCGGATCCCACAAGCCATCTTGGACA\
TGATCGCTGGTGCTCACTGGGGAGTCCTGGCGGGCATAGCGTATTTCTCCATGGTGGGGA\
ACTGGGCGAAGGTCCTGGTAGTGCTGCTGCTATTTGCCGGCGTCGACGCGGAAACCCACG\
TCACCGGGGGAAGTGCCGGCCACACTGTGTCTGGATTTGTTAGCCTCCTCGCACCAGGCG\
CCAAGCAGAACGTCCAGCTGATCAACACCAACGGCAGTTGGCACCTCAATAGCACGGCCC\
TGAACTGCAATGATAGCCTCAACACCGGCTGGTTGGCAGGGCTTTTCTATCACCACAAGT\
TCAACTCTTCAGGCTGTCCTGAGAGGCTAGCCAGCTGCCGACCCCTTACCGATTTTGACC\
AGGGCTGGGGCCCTATCAGTTATGCCAACGGAAGCGGCCCCGACCAGCGCCCCTACTGCT\
GGCACTACCCCCCAAAACCTTGCGGTATTGTGCCCGCGAAGAGTGTGTGTGGTCCGGTAT\
ATTGCTTCACTCCCAGCCCCGTGGTGGTGGGAACGACCGACAGGTCGGGCGCGCCCACCT\
ACAGCTGGGGTGAAAATGATACGGACGTCTTCGTCCTTAACAATACCAGGCCACCGCTGG\
GCAATTGGTTCGGTTGTACCTGGATGAACTCAACTGGATTCACCAAAGTGTGCGGAGCGC\
CTCCTTGTGTCATCGGAGGGGCGGGCAACAACACCCTGCACTGCCCCACTGATTGCTTCC\
GCAAGCATCCGGACGCCACATACTCTCGGTGCGGCTCCGGTCCCTGGATCACACCCAGGT\
GCCTGGTCGACTACCCGTATAGGCTTTGGCATTATCCTTGTACCATCAACTACACCATAT\
TTAAAATCAGGATGTACGTGGGAGGGGTCGAACACAGGCTGGAAGCTGCCTGCAACTGGA\
CGCGGGGCGAACGTTGCGATCTGGAAGACAGGGACAGGTCCGAGCTCAGCCCGTTACTGC\
TGACCACTACACAGTGGCAGGTCCTCCCGTGTTCCTTCACAACCCTACCAGCCTTGTCCA\
CCGGCCTCATCCACCTCCACCAGAACATTGTGGACGTGCAGTACTTGTACGGGGTGGGGT\
CAAGCATCGCGTCCTGGGCCATTAAGTGGGAGTACGTCGTTCTCCTGTTCCTTCTGCTTG\
'''


class Test_extract_hcv_orf(unittest.TestCase):
    '''Identify where orf is'''
    def setUp(self):
        self.seq_1a = Seq(subtype1a)

    def test_extract_1a(self):
        '''Test with genotype 1a'''
        s = extract_hcv_orf(self.seq_1a)
        sta = str(s.translate())
        self.assertEqual(sta[0], 'M')


if __name__ == '__main__':
    unittest.main()
